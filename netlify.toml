# Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶
# æ­¤æ–‡ä»¶æ‡‰æ”¾åœ¨é …ç›®æ ¹ç›®éŒ„

[build]
  # æ§‹å»ºå‘½ä»¤ï¼ˆå¦‚æœéœ€è¦ï¼‰
  command = "echo 'Building static site...'"
  
  # ç™¼å¸ƒç›®éŒ„
  publish = "."
  
  # Functions ç›®éŒ„
  functions = "netlify/functions"

# ç’°å¢ƒè®Šé‡ï¼ˆåœ¨ Netlify æ§åˆ¶é¢æ¿ä¸­è¨­ç½®å¯¦éš›å€¼ï¼‰
[build.environment]
  NODE_VERSION = "18"

# ğŸ”’ å®‰å…¨æ¨™é ­é…ç½®
[[headers]]
  for = "/*"
  [headers.values]
    # å…§å®¹å®‰å…¨ç­–ç•¥
    Content-Security-Policy = """
      default-src 'self';
      script-src 'self' 'unsafe-inline' https://d3js.org https://unpkg.com https://cdnjs.cloudflare.com;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
      font-src 'self' https://fonts.gstatic.com;
      img-src 'self' https: data: blob:;
      connect-src 'self' https://graph.instagram.com https://api.instagram.com;
      frame-ancestors 'none';
      base-uri 'self';
      form-action 'self';
    """
    
    # é˜²æ­¢é»æ“ŠåŠ«æŒ
    X-Frame-Options = "DENY"
    
    # é˜²æ­¢ MIME é¡å‹å—…æ¢
    X-Content-Type-Options = "nosniff"
    
    # å¼•ç”¨æ”¿ç­–
    Referrer-Policy = "strict-origin-when-cross-origin"
    
    # å¼·åˆ¶ HTTPS
    Strict-Transport-Security = "max-age=31536000; includeSubDomains"

# API å‡½æ•¸çš„ç‰¹æ®Šæ¨™é ­
[[headers]]
  for = "/.netlify/functions/*"
  [headers.values]
    # ç¦ç”¨ç·©å­˜æ•æ„Ÿ API éŸ¿æ‡‰
    Cache-Control = "no-store, no-cache, must-revalidate, max-age=0"
    
    # é¡å¤–å®‰å…¨æ¨™é ­
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "DENY"

# é‡å®šå‘è¦å‰‡ï¼ˆå¯é¸ï¼‰
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

# éŒ¯èª¤é é¢
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 404
